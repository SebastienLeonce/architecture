version: "3"
services:
  api:
    extends:
      file: ./packages/api/docker-compose.yml
      service: api
    depends_on:
      - db
  db:
    extends:
      file: ./packages/db/docker-compose.yml
      service: db
  db-admin:
    extends:
      file: ./packages/db-admin/docker-compose.yml
      service: db-admin
    depends_on:
      - db
  grafana:
    extends:
      file: ./packages/grafana/docker-compose.yml
      service: grafana
    depends_on:
      - prometheus
  prometheus:
    extends:
      file: ./packages/prometheus/docker-compose.yml
      service: prometheus
    depends_on:
      - api
      - cadvisor
  cadvisor:
    extends:
      file: ./packages/cadvisor/docker-compose.yml
      service: cadvisor
  traefik:
    extends:
      file: ./packages/traefik/docker-compose.yml
      service: traefik
    depends_on:
      - api
      - db-admin
      - grafana
      - prometheus
      - cadvisor
networks:
  local:
    driver: bridge

volumes:
  grafana-data:
  mongo-data:
    driver: local
